#:kivy 1.0.9
#:import get_color_from_hex kivy.utils.get_color_from_hex
# :import ButtonBehavior kivy.uix.behaviors.ButtonBehavior
# imports here

<InfoPopup>:
    title: "" 
    separator_height: 0
    size_hint: None, None
    size: 700, 1000
    pos_hint: {'center_x': 0.3, 'center_y': 0.5}
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: get_color_from_hex('#7AADFA')
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [25]  
        Label:
            text: 'Longitude:'
            color: 1, 1, 1, 1 
            font_size: '15sp'
            bold: True
        Label:
            text: 'Latitude:'
            color: 1, 1, 1, 1 
            font_size: '15sp'
            bold: True
        Label:
            text: 'Tone:'
            color: 1, 1, 1, 1 
            font_size: '15sp'
            bold: True
        Label:
            text: 'Transmissions Sent:'
            color: 1, 1, 1, 1 
            font_size: '15sp'
            bold: True
        
        RoundedButton:
            text: 'Close'
            background_color: get_color_from_hex('#1F448C')  # Button color to match other buttons
            color: 1, 1, 1, 1  # White text color
            size_hint_y: None
            height: '50dp'
            font_size: '20sp'
            bold: True
            on_press: root.dismiss()


            
<TouchScreen>:

    orientation: 'vertical'

    BoxLayout: # BoxLayout for the top label
        size_hint_y: None
        height: '65dp'
        padding: '5dp'
        canvas.before:
            Color:
                rgba: get_color_from_hex('#7AADFA')
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [10]
        Label: #Padding Label
            text: 'GENERAL DYNAMICS'
            color: 1, 1, 1, 1
            size_hint_x: None
            width: self.texture_size[0] + 20
            font_size: '24sp'
            bold: True

        ActivationProgressBar:
            id: activation_progress
            size_hint_y: None
            
        RoundedButton:
            text: 'POWER'
            background_color: get_color_from_hex('#1F448C')
            size_hint_x: None
            width: '168dp'
            size_hint_y: 1
            font_size: '24sp'
            bold: True

    GridLayout: #Main Grid Setup
        cols: 2
        spacing: '20dp'
        padding: '25dp'

        GridLayout: #Status Grid Layout
            id: status_area
            rows: 10
            spacing: '10dp'
            size_hint_x: None
            width: '450dp'
            canvas.before:
                Color:
                    rgba: get_color_from_hex('#7AADFA')
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [25]
            # Status Labels
            Label:
                text: ''
                color: 1, 1, 1, 1
                size_hint_y: None
                height: '5dp'
                font_size: '20sp'
                bold: True
            Label:
                id: operating_mode_label
                text: 'OPERATING MODE: ' + root.mode_text
                color: 1, 1, 1, 1
                size_hint_y: None
                padding: 
                height: '30dp'
                font_size: '25sp'
                bold: True
            
            Label:
                markup: True
                text: "READY: [color=00ff00]YES[/color]" if root.sd_card_ready and root.rf_transmitter_ready and root.system_controller_ready and root.downlink_status_ready else "READY: [color=ff0000]NO[/color]"
                color: 1, 1, 1, 1
                size_hint_y: None
                height: '30dp'
                font_size: '25sp'
                bold: True
            # Padding label, no changes needed here
            Label:
                text: ''
                color: 1, 1, 1, 1
                size_hint_y: None
                height: '15dp'
                font_size: '20sp'
                bold: True

            # SD CARD label, already correctly formatted
            Label:
                markup: True
                text: "SD CARD: [color=00ff00]Ready[/color]" if root.sd_card_ready else "SD CARD: [color=ff0000]Not Ready[/color]"
                color: 1, 1, 1, 1
                size_hint_y: None
                height: '30dp'
                font_size: '25sp'
                bold: True

            # RF TRANSMITTER label with markup
            Label:
                markup: True
                text: "RF TRANSMITTER: [color=00ff00]Ready[/color]" if root.rf_transmitter_ready else "RF TRANSMITTER: [color=ff0000]Not Ready[/color]"
                color: 1, 1, 1, 1
                size_hint_y: None
                height: '30dp'
                font_size: '25sp'
                bold: True

            # SYSTEM CONTROLLER label with markup
            # Label:
            #     markup: True
            #     text: "SYSTEM CONTROLLER: [color=00ff00]Ready[/color]" if root.system_controller_ready else "SYSTEM CONTROLLER: [color=ff0000]Not Ready[/color]"
            #     color: 1, 1, 1, 1
            #     size_hint_y: None
            #     height: '30dp'
            #     font_size: '25sp'
            #     bold: True

            # DOWNLINK STATUS label with markup
            # Label:
            #     markup: True
            #     text: "DOWNLINK STATUS: [color=00ff00]Ready[/color]" if root.downlink_status_ready else "DOWNLINK STATUS: [color=ff0000]Not Ready[/color]"
            #     color: 1, 1, 1, 1
            #     size_hint_y: None
            #     height: '30dp'
            #     font_size: '20sp'
            #     bold: True

            # This label appears to be for spacing, no changes needed
            Label:
                text: ''
                color: 1, 1, 1, 1
                size_hint_y: None
                height: '16dp'
                font_size: '20sp'
                bold: True,

            BoxLayout:
                size_hint_x: 1
                size_hint_y: None
                height: '45dp'


                Widget:  # This empty widget will take up 1/3 of the space on x plane
                    size_hint_x: 0.33

                # RoundedButton:
                #     text: 'MORE INFO'
                #     background_color: get_color_from_hex('#1F448C')
                #     size_hint_x: None
                #     width: '200dp'
                #     size_hint_y: 1.1
                #     font_size: '20sp'
                #     bold: True
                #     on_release: root.toggle_info_popup()

                Widget:  # This empty widget will also take up 1/3 of the space on x plane
                    size_hint_x: 0.33
    

        GridLayout: # Second grid layout
            id: buttons_area
            rows: 5  #extra rows for space
            spacing: '10dp'

            BoxLayout: #Time Box
                orientation: 'vertical'
                size_hint_y: None
                height: '125dp'
                padding: 49
                canvas.before:
                    Color:
                        rgba: get_color_from_hex('#7AADFA')
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [25] 

                Label:
                    id: time_label
                    text: '00:00'
                    color: 1, 1, 1, 1
                    size_hint_y: None
                    height: '25dp'
                    font_size: '48sp'
                    bold: True
                Widget:  # This empty widget will take up 1/3 of the space on x plane
                    size_hint_x: 0.05

            BoxLayout: # Operating States Button Box
                orientation: 'vertical'
                size_hint_y: None
                height: '250dp'  
                padding: 10
                canvas.before:
                    Color:
                        rgba: get_color_from_hex('#7AADFA') 
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [15]

                RoundedButton:
                    text: 'ACTIVE'
                    background_color: get_color_from_hex('#1F448C')
                    size_hint: 1, 0.3 
                    font_size: '24sp'
                    bold: True
                    on_release: app.root.activate_active_mode()

                RoundedButton:
                    text: 'PASSIVE'
                    background_color: get_color_from_hex('#1F448C')
                    size_hint: 1, 0.3  
                    font_size: '24sp'
                    bold: True
                    on_release: app.root.activate_passive_mode()

                RoundedButton:
                    text: 'STANDBY'
                    background_color: get_color_from_hex('#1F448C')
                    size_hint: 1, 0.3  
                    font_size: '24sp'
                    bold: True
                    on_release: app.root.activate_standby_mode()